# Protocol: Finalizing the Computational Toolchain

**Document Version:** 1.0
**Date:** September 27, 2025
**Associated Project Task:** Week 1 - Scoping, Data Acquisition & Toolchain Finalization

---

## 1. Objective

To formally document the primary Python libraries and their versions that will constitute the project's computational environment. This ensures a stable, consistent, and reproducible software stack for all analyses.

## 2. Rationale and Strategic Justification

Methodological transparency and computational reproducibility are core principles of this project. A formally defined toolchain, managed through a version-controlled environment file, is the only way to guarantee that the analysis can be replicated by others (or by yourself in the future) with identical results. This addresses a critical weakness in many scientific workflows where dependency conflicts or library updates can break code or alter outcomes. This task establishes a stable foundation upon which all subsequent work will be built, ensuring the entire analytical pipeline is robust and portable.

## 3. Finalized Toolchain

The following table details the selected libraries for each major component of the analytical pipeline, along with the justification for each choice based on the project's specific requirements.

| Component | Primary Library | Justification for Selection |
| :--- | :--- | :--- |
| **Geospatial I/O & Data Structures** | `rasterio`, `rioxarray`, `geopandas` | The industry-standard stack for reading, writing, and manipulating raster and vector data in Python. `rioxarray` provides the crucial bridge between `rasterio` and `xarray`, enabling labeled, multi-dimensional array analysis. |
| **Parallel Processing** | `dask` | Enables scalable, out-of-core processing of larger-than-memory DEMs. Essential for implementing the Dynamic Resource Allocation Framework, which is a key methodological contribution of this project. |
| **Geomorphometry** | `whitebox` | Python frontend for the high-performance `whitebox-tools` library. Selected for its comprehensive suite of over 400 advanced and well-documented geomorphometric and GIS tools, providing a single, consistent environment for analysis. |
| **Topological Data Analysis (TDA)** | `scikit-tda` (`ripser.py`, `persim`) | Provides state-of-the-art performance for persistent homology computation (`ripser`) and a rich set of vectorization methods (`persim`), including Persistence Landscapes and Images. This ecosystem is ideal for the project's dual focus on statistical analysis and machine learning integration. |
| **Spatial Sampling** | `BalancedSampling` | The specific Python implementation of the Local Cube method, which is required by the project's stratified, doubly balanced sampling design to minimize variance and maximize statistical power. |
| **Machine Learning & Interpretation** | `scikit-learn`, `shap` | `scikit-learn` is the standard for robust implementation of the Random Forest and Gradient Boosting models. `shap` is the state-of-the-art library for model interpretation, essential for understanding the predictive power of topological features as required by hypothesis $H_2$. |

## 4. Implementation Protocol

1.  **Environment Creation:** Create a dedicated `conda` environment for the project.
2.  **Library Installation:** Install the specified libraries, prioritizing installation from the `conda-forge` channel for best compatibility.
3.  **Environment Export:** Once all libraries are installed and confirmed to work, export the environment to an `environment.yml` file using the command `conda env export > environment.yml`. This file will lock in the exact versions of all packages and their dependencies.
4.  **Version Control:** Commit the `environment.yml` file to the project's version control repository (e.g., GitHub).

## 5. Deliverables

1.  **`environment.yml`**: A complete, version-locked `conda` environment file that allows for the one-step recreation of the project's computational environment.
2.  **Updated Documentation**: A markdown cell in the project's main README file or a dedicated document in a `/docs` directory that lists the finalized toolchain and briefly summarizes the rationale for the key library selections, referencing this protocol.

## 6. Quality Control Checklist

* [ ] The `environment.yml` file has been created and committed to version control.
* [ ] The project environment can be successfully recreated from the `environment.yml` file.
* [ ] All primary libraries listed in the toolchain table are included in the environment file.
* [ ] Project documentation has been updated to reflect the finalized toolchain.