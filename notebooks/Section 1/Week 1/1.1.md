# Protocol: Finalizing Study Area Polygons and Hold-Out Validation Area

**Document Version:** 1.0
**Date:** September 27, 2025
**Associated Project Task:** Week 1 - Scoping & Finalizing Covariates

---

## 1. Objective

The primary objective of this task is to formally define and delineate the spatial extents for the project's primary analysis and its independent validation. This involves selecting multiple, distinct **study area polygons** where models will be trained and hypotheses tested, and a single, spatially independent **hold-out validation area polygon** to provide an honest measure of model generalizability.

## 2. Rationale and Strategic Justification

This is the foundational step of the entire analytical pipeline. The selection of study areas directly impacts the project's ability to rigorously test its core hypotheses:

* **For $H_1$ (Landscape Characterization):** The hypothesis states that "geomorphic provinces exhibit statistically distinct multiscale topological signatures." To test this, we require study areas that are chosen *a priori* from different, well-established geomorphic provinces. The contrast between these provinces provides the basis for the statistical comparison. A poor or arbitrary choice of study areas would undermine the validity of any classification results.
* **For $H_2$ (Process Prediction):** The goal is to predict erosion potential (derived from the WEPP model) using topological signatures. By training the model across multiple distinct geomorphic settings, we increase the likelihood that the model learns fundamental relationships between landscape shape and process, rather than spurious correlations specific to a single landscape type.
* **For External Validation:** The use of a spatially separate hold-out area is a critical component of robust scientific methodology. It prevents information leakage and provides the only reliable measure of how well the final models perform on "unseen" data, a key indicator of their scientific utility and potential for broader application.

## 3. Recommended Data Source

To ensure an objective and reproducible selection, the study areas should be based on an authoritative, widely accepted delineation of geomorphic or physiographic regions.

* **Primary Source:** **Physiographic Provinces of the Conterminous United States**, as originally defined by Fenneman (1946) and subsequently digitized.
* **Recommended Acquisition:** This dataset is available from multiple sources. A reliable, easy-to-use version can be found in **Esri's Living Atlas of the World** or through the **USGS ScienceBase Catalog**. Search for "Physiographic Provinces."
    * *Direct Link (Example):* [USGS Physiographic Provinces Data Release](https://www.sciencebase.gov/catalog/item/504108bde4b04b8a0323998b)

## 4. Criteria for Study Area Selection (Training Polygons)

Select **at least two** polygons from the source shapefile to serve as the primary study areas. The selection should be guided by the following principles:

1.  **Maximize Geomorphic Contrast:** The chosen provinces should be distinctly different in terms of their characteristic topography, geologic history, and dominant surface processes. This provides a strong basis for testing the classification hypothesis ($H_{A1}$).
    * *Example:* Selecting the **"Blue Ridge province"** (high-relief, crystalline rock, dendritic drainage) and the **"Piedmont Upland section"** of the Piedmont province (moderate-relief, rolling hills) would provide an excellent contrast.
2.  **Ensure High-Quality Data Availability:** Confirm that high-resolution, high-quality DEM data is available for the entirety of the selected polygons. The **USGS 3DEP 1/3 arc-second (~10m) DEM** is the target dataset for this project.
3.  **Sufficient and Comparable Scale:** The selected polygons should be large enough to contain a representative sample of the province's landforms (recommended minimum area: >5,000 kmÂ²) but should be of a roughly comparable size to ensure a balanced statistical design.

## 5. Criteria for Hold-Out Validation Area Selection

Select **one** polygon to serve as the hold-out validation area. This choice is critical for ensuring the final results are robust and generalizable.

1.  **Strict Spatial Independence:** The validation polygon **must not** share a border with or be contiguous to any of the primary study area polygons.
2.  **Geomorphic Representativeness:** The validation area should ideally encompass a range of topographic forms and processes similar to those found in the training areas, but within a different structural and historical context. This provides a fair and challenging test for the models.
    * *Example:* The **"Valley and Ridge province"** would be an excellent choice. It contains both high- and low-relief areas but with a strong, linear structural grain that is distinct from the Blue Ridge and Piedmont, providing a novel landscape on which to test the trained models.

## 6. Implementation Protocol (Jupyter Notebook Workflow)

The following steps outline the procedure to be implemented in a Jupyter Notebook using `geopandas` and `pyproj`.

### Step 1: Acquire and Load Province Data

Download the recommended physiographic provinces shapefile and place it in the project's `data/raw/` directory. Load it into a GeoDataFrame.

### Step 2: Inspect Data and Select Polygons

Examine the attributes of the GeoDataFrame to identify the names of the provinces. Filter the dataframe to isolate the desired polygons for the study and validation areas based on the criteria in Sections 4 and 5.

### Step 3: Define a Target Coordinate Reference System (CRS)

All subsequent analyses will require a projected CRS to ensure accurate area and distance calculations. A standard Albers Equal Area Conic projection is recommended for the conterminous US.

* **Recommended CRS:** EPSG:5070 - NAD83 / Conus Albers

### Step 4: Process and Reproject Polygons

Create separate GeoDataFrames for the study areas and the validation area. Reproject them to the target CRS (EPSG:5070).

### Step 5: Calculate Area and Finalize Attributes

Calculate the area of each selected polygon in square kilometers and add this as an attribute. Ensure the final attribute tables contain only essential information (e.g., `PROVINCE_NAME`, `AREA_SQKM`).

### Step 6: Export Final Deliverables

Save the finalized GeoDataFrames to a clean, project-standard `data/processed/` directory using a non-proprietary format like GeoPackage (`.gpkg`).

## 7. Deliverables

The successful completion of this task will produce the following files and notebook outputs.

1.  **`study_areas.gpkg`**: A single GeoPackage file containing the two (or more) finalized polygons for the main analysis.
    * **Geometry:** Polygon
    * **CRS:** EPSG:5070
    * **Required Attributes:** `PROVINCE` (string), `AREA_SQKM` (float)
2.  **`validation_area.gpkg`**: A single GeoPackage file containing the one finalized polygon for the hold-out validation.
    * **Geometry:** Polygon
    * **CRS:** EPSG:5070
    * **Required Attributes:** `PROVINCE` (string), `AREA_SQKM` (float)
3.  **Jupyter Notebook (`01_finalize_study_areas.ipynb`)**: A fully executed notebook containing the code and a final markdown cell that:
    * Explicitly states the selected provinces for study and validation.
    * Provides a brief (2-3 sentence) justification for each choice, referencing the selection criteria.
    * Reports the final calculated area for each polygon.

## 8. Quality Control Checklist

Before proceeding to the next project stage, verify the following:

* [ ] Polygons are derived from the authoritative Fenneman (1946) source.
* [ ] Final files are in the specified GeoPackage (`.gpkg`) format.
* [ ] The Coordinate Reference System for both output files is EPSG:5070.
* [ ] The validation area is spatially non-contiguous with all study areas.
* [ ] The Jupyter Notebook includes a clear summary and justification for the final selections.
* [ ] Attribute tables are clean and contain the required fields.